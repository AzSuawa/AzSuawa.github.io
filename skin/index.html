<!DOCTYPEhtml><htmllang="zh-CN"><head><metacharset="UTF-8"><metaname="viewport"content="width=device-width,initial-scale=1.0"><title>上传皮肤到服务器-素素の生存服(p≧w≦q)</title><metaname="description"content="上传皮肤到服务器-素素の生存服、azsu.top、小小素QQ机器人"><metaname="theme-color"content="#A1BDFF"><linkrel="stylesheet"href="/css/all.min.css"><linkrel="stylesheet"href="/css/style.css"><linkrel="icon"href="/images/favicon.ico"><style>.skin-upload-container{max-width:500px;margin:0auto}.skin-drop-area{border:2pxdashed#6c757d;border-radius:6px;padding:30px;text-align:center;margin-bottom:20px;transition:all.3s;background:#f8f9fa}.skin-drop-area.highlight{border-color:#28a745;background:#e8f5e9}.skin-btn{background:var(--primary-color);color:white;padding:10px20px;border:none;border-radius:4px;cursor:pointer;font-size:16px;margin:10px5px;transition:background-color.3s}.skin-btn:hover{background:#8CAEFF}.skin-progress-container{margin-top:20px;display:none}.skin-progress{width:100%;height:20px;border-radius:4px}.skin-file-list{margin-top:20px;max-height:300px;overflow-y:auto}.skin-file-item{display:flex;justify-content:space-between;padding:10px;border-bottom:1pxsolid#eee;align-items:center}.skin-file-info{display:flex;align-items:center}.skin-file-icon{margin-right:10px;color:#6c757d}.skin-file-status{font-weight:bold}.skin-status-pending{color:#ffc107}.skin-status-success{color:#28a745}.skin-status-error{color:#dc3545}.skin-form-group{margin-bottom:15px}.skin-form-grouplabel{display:block;margin-bottom:5px;font-weight:bold}.skin-form-groupinput{width:calc(100%-2px);padding:10px;border:1pxsolid#ced4da;border-radius:4px;font-size:14px;box-sizing:border-box}.skin-file-size-limit{color:#6c757d;font-size:14px;margin-top:5px}.skin-preview-link{color:#007bff;text-decoration:none;margin-left:10px}.skin-preview-link:hover{text-decoration:underline}#fileInput{display:none}.captcha-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;z-index:999}.captcha-card{background:var(--card-bg);border-radius:8px;box-shadow:04px20pxrgba(0,0,0,.15);width:100%;max-width:380px;overflow:hidden;display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000}.captcha-card-header{padding:16px20px;border-bottom:1pxsolidvar(--border-color);position:relative}.captcha-card-title{font-size:18px;font-weight:bold;margin:006px0;color:var(--text-color)}.captcha-cueword{font-weight:bold;color:var(--primary-color)}.captcha-verification-container{padding:8px16px8px}.captcha-image-wrapper{width:100%;margin:8px012px;position:relative}.captcha-image-container{position:relative;width:100%;padding-top:100%;overflow:hidden;border:2pxsolidvar(--border-color);border-radius:4px;background:#f9f9f9}.captcha-image-containerimg{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.captcha-grid-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(4,1fr)}.captcha-grid-cell{border:2pxsolidrgba(0,0,0,.3);transition:all.2s;cursor:pointer;box-sizing:border-box}.captcha-grid-cell:hover{background:var(--hover-bg)}.captcha-grid-cell.selected{background:rgba(161,189,255,.4);border-color:var(--primary-color)}.captcha-card-footer{display:flex;justify-content:space-between;align-items:center;padding:12px20px;border-top:1pxsolidvar(--border-color)}.captcha-footer-text{font-size:14px;color:#999}.captcha-btn{background:var(--primary-color);color:white;border:none;border-radius:4px;padding:6px14px;font-size:14px;cursor:pointer;transition:background-color.2s}.captcha-btn:hover{background:var(--hover-blue)}.captcha-btn:disabled{background:#ccc;cursor:not-allowed}.captcha-btn-cancel{background:#f1f1f1;color:#666;margin-right:8px}.captcha-btn-cancel:hover{background:#e5e5e5}.captcha-loading{opacity:.6;pointer-events:none}.captcha-success-message,.captcha-error-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.7);color:white;padding:16px24px;border-radius:4px;font-weight:bold;display:none;z-index:1001}.captcha-error-message{max-width:300px;text-align:center}.captcha-close-btn{position:absolute;top:12px;right:12px;background:none;border:none;font-size:20px;cursor:pointer;color:#999}.captcha-close-btn:hover{color:#333}.card{display:block!important}</style></head><body><divid="header"><buttonid="menu-btn"><iclass="fasfa-bars"></i></button><divid="title">素素の生存服</div></div><divid="sidebar"></div><divid="content"><divclass="cardactive"><h1>上传皮肤到服务器</h1><divclass="command-sectionskin-upload-container"><divclass="skin-form-group"><labelfor="playerId">玩家ID:</label><inputtype="text"id="playerId"placeholder="请输入你的游戏名"required></div><divclass="skin-drop-area"id="dropArea"><p>可拖放文件到此处</p><buttonclass="skin-btn"id="selectBtn">选择文件</button><inputtype="file"id="fileInput"accept="image/png"><divclass="skin-file-size-limit">仅支持原版皮肤(PNG,64×64)</div></div><divclass="skin-progress-container"id="progressContainer"><pid="statusText">准备上传...</p><progressclass="skin-progress"id="uploadProgress"value="0"max="100"></progress></div><divclass="skin-file-list"id="fileList"></div></div></div></div><divclass="captcha-overlay"id="captchaOverlay"></div><divclass="captcha-card"id="captchaCard"><divclass="captcha-card-header"><h2class="captcha-card-title">请选择所有包含<spanid="cueword"class="captcha-cueword">加载中</span>的内容</h2><buttonclass="captcha-close-btn"id="captchaCloseBtn">×</button></div><divclass="captcha-verification-container"><divclass="captcha-image-wrapper"><divclass="captcha-image-container"><imgid="captchaImage"alt="验证图片"style="display:none"><divclass="captcha-grid-overlay"id="captchaGridOverlay"></div><divid="captchaCenterMessage">正在初始化...</div></div></div></div><divclass="captcha-card-footer"><spanclass="captcha-footer-text">By阿素本素</span><div><buttonclass="captcha-btncaptcha-btn-cancel"id="captchaCancelBtn">取消</button><buttonclass="captcha-btn"id="captchaSubmitBtn"disabled>继续</button></div></div></div><divclass="captcha-success-message"id="captchaSuccessMessage">验证成功！</div><divclass="captcha-error-message"id="captchaErrorMessage"><divid="captchaErrorText"></div></div><scriptsrc="/js/main.js"></script><script>constdropArea=document.getElementById('dropArea');constfileInput=document.getElementById('fileInput');constselectBtn=document.getElementById('selectBtn');constprogressContainer=document.getElementById('progressContainer');constuploadProgress=document.getElementById('uploadProgress');conststatusText=document.getElementById('statusText');constfileList=document.getElementById('fileList');constplayerIdInput=document.getElementById('playerId');constcaptchaOverlay=document.getElementById('captchaOverlay');constcaptchaCard=document.getElementById('captchaCard');constcaptchaGridOverlay=document.getElementById('captchaGridOverlay');constcaptchaSubmitBtn=document.getElementById('captchaSubmitBtn');constcaptchaCancelBtn=document.getElementById('captchaCancelBtn');constcaptchaCloseBtn=document.getElementById('captchaCloseBtn');constcaptchaImage=document.getElementById('captchaImage');constcuewordElement=document.getElementById('cueword');constcaptchaCenterMessage=document.getElementById('captchaCenterMessage');constcaptchaSuccessMessage=document.getElementById('captchaSuccessMessage');constcaptchaErrorMessage=document.getElementById('captchaErrorMessage');constcaptchaErrorText=document.getElementById('captchaErrorText');letselectedCells=[];letcurrentToken='';letverificationInProgress=false;letpendingFiles=null;letpendingPlayerId='';for(leti=0;i<16;i++){constcell=document.createElement('div');cell.className='captcha-grid-cell';cell.dataset.index=i;cell.addEventListener('click',function(){if(verificationInProgress)return;this.classList.toggle('selected');constindex=parseInt(this.dataset.index);if(this.classList.contains('selected')){if(!selectedCells.includes(index)){selectedCells.push(index)}}else{selectedCells=selectedCells.filter(item=>item!==index)}captchaSubmitBtn.disabled=selectedCells.length===0});captchaGridOverlay.appendChild(cell)}selectBtn.addEventListener('click',()=>{fileInput.click()});fileInput.addEventListener('change',()=>{handleFiles(fileInput.files)});['dragenter','dragover','dragleave','drop'].forEach(eventName=>{dropArea.addEventListener(eventName,preventDefaults,false)});functionpreventDefaults(e){e.preventDefault();e.stopPropagation()}['dragenter','dragover'].forEach(eventName=>{dropArea.addEventListener(eventName,()=>dropArea.classList.add('highlight'),false)});['dragleave','drop'].forEach(eventName=>{dropArea.addEventListener(eventName,()=>dropArea.classList.remove('highlight'),false)});dropArea.addEventListener('drop',handleDrop,false);functionhandleDrop(e){constfiles=e.dataTransfer.files;handleFiles(files)}functionhandleFiles(files){fileList.innerHTML='';constplayerId=playerIdInput.value.trim();if(!playerId){showError('请先输入玩家ID(p≧w≦q)');return}constpngFiles=Array.from(files).filter(file=>file.type==='image/png');if(pngFiles.length===0){showError('请选择PNG格式的皮肤文件(p≧w≦q)');return}constoversizedFiles=pngFiles.filter(file=>file.size>10*1024);if(oversizedFiles.length>0){showError(`文件"${oversizedFiles[0].name}"超过10KB限制(p≧w≦q)`);return}constfile=pngFiles[0];constimg=newImage();img.onload=function(){if(this.width!==64||this.height!==64){showError('皮肤图片尺寸必须是64x64像素(p≧w≦q)');return}constfileItem=document.createElement('div');fileItem.className='skin-file-item';fileItem.innerHTML=`<divclass="skin-file-info"><spanclass="skin-file-icon">📄</span><span>${file.name}(${formatFileSize(file.size)})</span></div><spanclass="skin-file-statusskin-status-pending">等待验证</span>`;fileList.appendChild(fileItem);pendingFiles=pngFiles;pendingPlayerId=playerId;startCaptchaVerification()};img.onerror=function(){showError('无法读取图片文件(p≧w≦q)')};img.src=URL.createObjectURL(file)}functionstartCaptchaVerification(){showCaptcha();initVerification()}functionshowCaptcha(){captchaCard.style.display='block';captchaOverlay.style.display='block'}functionhideCaptcha(){captchaCard.style.display='none';captchaOverlay.style.display='none'}asyncfunctioninitVerification(){try{setCaptchaLoading(true);updateCenterMessage('正在初始化...');clearCaptchaToken();consttokenResponse=awaitfetch('https:consttokenData=awaittokenResponse.json();if(tokenData.code===10000){currentToken=tokenData.data.captcha_token;updateCenterMessage('正在加载验证图片...');awaitloadCaptchaImage()}else{showCaptchaError('获取验证令牌失败:'+tokenData.message);setCaptchaLoading(false);hideCaptcha()}}catch(error){showCaptchaError('初始化验证失败:'+error.message);setCaptchaLoading(false);hideCaptcha()}}asyncfunctionloadCaptchaImage(){try{constresponse=awaitfetch(`https:constdata=awaitresponse.json();if(data.code===16001||data.code===10000){if(data.data.image_base64){captchaImage.src='data:image/jpeg;base64,'+data.data.image_base64;captchaImage.style.display='block';hideCenterMessage()}if(data.data.cueword){cuewordElement.textContent=data.data.cueword}setCaptchaLoading(false)}else{showCaptchaError('加载验证图片失败:'+data.message);setCaptchaLoading(false);hideCaptcha()}}catch(error){showCaptchaError('加载验证图片失败:'+error.message);setCaptchaLoading(false);hideCaptcha()}}captchaSubmitBtn.addEventListener('click',submitCaptcha);captchaCancelBtn.addEventListener('click',cancelCaptcha);captchaCloseBtn.addEventListener('click',cancelCaptcha);asyncfunctionsubmitCaptcha(){if(verificationInProgress||selectedCells.length===0)return;verificationInProgress=true;captchaSubmitBtn.disabled=true;setCaptchaLoading(true);updateCenterMessage('正在验证...');try{constresponse=awaitfetch(`https:constdata=awaitresponse.json();if(data.code===16002||(data.code===10000&&data.data.status==='success')){hideCaptcha();setTimeout(()=>{showCaptchaSuccess();storeCaptchaToken(currentToken);setTimeout(()=>{resetCaptchaSelection();uploadFile(pendingFiles[0],pendingPlayerId)},1000)},10)}elseif(data.code===16001&&data.data.status==='processing'){updateCenterMessage('正在加载验证图片...');if(data.data.image_base64){captchaImage.src='data:image/jpeg;base64,'+data.data.image_base64}if(data.data.cueword){cuewordElement.textContent=data.data.cueword}resetCaptchaSelection();setCaptchaLoading(false)}else{showCaptchaError('验证失败:'+(data.message||'未知错误'));setCaptchaLoading(false)}}catch(error){showCaptchaError('验证请求失败:'+error.message);setCaptchaLoading(false)}finally{verificationInProgress=false}}functioncancelCaptcha(){hideCaptcha();resetCaptchaSelection();pendingFiles=null;pendingPlayerId='';fileList.innerHTML=''}functionresetCaptchaSelection(){selectedCells=[];document.querySelectorAll('.captcha-grid-cell.selected').forEach(cell=>{cell.classList.remove('selected')});captchaSubmitBtn.disabled=true}functionsetCaptchaLoading(loading){if(loading){captchaCard.classList.add('captcha-loading')}else{captchaCard.classList.remove('captcha-loading')}verificationInProgress=loading}functionupdateCenterMessage(message){captchaCenterMessage.textContent=message}functionhideCenterMessage(){captchaCenterMessage.textContent=''}functionshowCaptchaSuccess(){captchaSuccessMessage.style.display='block';setTimeout(()=>{captchaSuccessMessage.style.display='none'},1000)}functionshowCaptchaError(message){captchaErrorText.textContent=message;captchaErrorMessage.style.display='block';setTimeout(()=>{captchaErrorMessage.style.display='none'},3000)}functionstoreCaptchaToken(token){localStorage.setItem('captcha_token',token);localStorage.setItem('captcha_token_expires',(Math.floor(Date.now()/1000)+240).toString())}functionclearCaptchaToken(){localStorage.removeItem('captcha_token');localStorage.removeItem('captcha_token_expires')}functionuploadFile(file,playerId){progressContainer.style.display='block';statusText.textContent='准备上传...';statusText.style.color='';uploadProgress.value=0;constformData=newFormData();formData.append('file',file);formData.append('player_id',playerId);formData.append('captcha_token',currentToken);constxhr=newXMLHttpRequest();xhr.open('POST','https:xhr.setRequestHeader('Accept','application/json');xhr.upload.onprogress=function(e){if(e.lengthComputable){constpercent=Math.round((e.loaded/e.total)*100);uploadProgress.value=percent;statusText.textContent=`上传中:${percent}%`;constfileItem=document.querySelector('.skin-file-item');fileItem.querySelector('.skin-file-status').textContent=`${percent}%`;fileItem.querySelector('.skin-file-status').className='skin-file-statusskin-status-pending'}};xhr.onload=function(){constfileItem=document.querySelector('.skin-file-item');if(xhr.status===200||xhr.status===400){try{constresponse=JSON.parse(xhr.responseText);if(response.code===14000){statusText.textContent='文件上传成功(p≧w≦q)';statusText.style.color='#28a745';uploadProgress.value=100;updateFileStatus(fileItem,'上传成功','success');addPreviewLink(fileItem,playerId)}else{statusText.textContent=response.message||'上传失败';statusText.style.color='#dc3545';updateFileStatus(fileItem,response.message||'上传失败','error')}}catch(e){statusText.textContent='服务器响应异常';statusText.style.color='#dc3545';updateFileStatus(fileItem,'服务器异常','error')}}else{statusText.textContent=`上传失败(${xhr.status})`;statusText.style.color='#dc3545';updateFileStatus(fileItem,`失败:${xhr.status}`,'error')}fileInput.value='';pendingFiles=null;pendingPlayerId=''};xhr.onerror=function(){statusText.textContent='网络错误(p≧w≦q)';statusText.style.color='#dc3545';constfileItem=document.querySelector('.skin-file-item');updateFileStatus(fileItem,'网络错误','error');fileInput.value='';pendingFiles=null;pendingPlayerId=''};xhr.send(formData)}functionupdateFileStatus(fileItem,text,type){conststatusSpan=fileItem.querySelector('.skin-file-status');statusSpan.textContent=text;statusSpan.className=`skin-file-statusskin-status-${type}`}functionaddPreviewLink(fileItem,playerId){constpreviewLink=document.createElement('a');previewLink.href='https:previewLink.textContent='查看皮肤';previewLink.className='skin-preview-link';previewLink.target='_blank';fileItem.appendChild(previewLink)}functionshowError(message){statusText.textContent=message;statusText.style.color='#dc3545';progressContainer.style.display='block'}functionformatFileSize(bytes){if(bytes===0)return'0Bytes';constk=1024;constsizes=['Bytes','KB','MB','GB'];consti=Math.floor(Math.log(bytes)/Math.log(k));returnparseFloat((bytes/Math.pow(k,i)).toFixed(2))+''+sizes[i]}</script></body></html>